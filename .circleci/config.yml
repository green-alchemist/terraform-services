version: 2.1

# 1. You must enable "setup" to use in-repo orbs.
setup: true

orbs:
  path-filtering: circleci/path-filtering@2.0.4
  # 2. Define the 'monorepo-orb' alias and point it to your local orb file.
  monorepo-orb:
    orb: .circleci/orbs/orb.yml

workflows:
  setup:
    jobs:
      - path-filtering/filter:
          base-revision: master
          # 3. This config path now points to a much simpler helper file.
          config-path: .circleci/continuation-config.yml
          mapping: |
            services/.*\.tf .circleci/pipelines/infrastructure.yml
            ci/.*\.tf .circleci/pipelines/infrastructure.yml
            services/portfolio-gatsby/.* .circleci/pipelines/portfolio-gatsby.yml

